<!DOCTYPE html>
<html>
<head>
<title>Flash Player Matrix</title>
</head>

<style type="text/css">
  #flash-matrix
  {
    margin: auto;
    width: 50%;
    padding: 10px;
  }
</style>

<body>



<div id="flash-matrix">
  <h1>Flash Player Matrix</h1>
  <p>Flash Player Conformance Matrix. WIP</p>
  <p>The matrix gives an appromimate compatibility of <a href="https://mozilla.github.io/shumway/">Shumway</a>, <a href="https://lightspark.github.io/">Lightspark</a> and <a href="https://www.gnu.org/software/gnash/">Gnash</a> flash players compared to Adobe Flash Player</p>
</div>

<script>
var flashPlayers = ["adobeflash", "shumway", "lightspark", "gnash"];
var container = document.getElementById("flash-matrix");
fetch('flash-matrix.json')
  .then(response => response.text())
  .then((data) => {
    json = JSON.parse(data);

    var statsTable = document.createElement("table");
    var featureTotalCount = 0;
    for (category in json)
    {
      for (feature in json[category])
      {
        featureTotalCount++;
      }
    }

    for (player in flashPlayers)
    {
      var playerFeatureCount = 0;
      for (category in json)
      {
        for (feature in json[category])
        {
          if (json[category][feature][flashPlayers[player]] == "Yes")
          {
            playerFeatureCount++;
          }
        }
      }
      var playerStatsTr = document.createElement("tr");
      var playerName = document.createElement("td");
      playerName.innerHTML = flashPlayers[player];
      var playerComplience = document.createElement("td");
      playerComplience.innerHTML = playerFeatureCount;
      playerStatsTr.appendChild(playerName);
      playerStatsTr.appendChild(playerComplience);
      statsTable.appendChild(playerStatsTr);
    }
    container.appendChild(statsTable);

    for (var category in json) {
      var table = document.createElement("table");

      var header = document.createElement("tr");
      var blankHeaderItem = document.createElement("td");
      blankHeaderItem.innerHTML = "<strong>" + category + "</strong>";
      header.appendChild(blankHeaderItem);
      for (player in flashPlayers)
      {
        var playerTd = document.createElement("td");
        playerTd.innerHTML = flashPlayers[player];
        header.appendChild(playerTd);
      }
      table.appendChild(header);

      for (feature in json[category])
      {
        var tr = document.createElement("tr");

        var featureTd = document.createElement("td");
        featureTd.innerHTML = feature;
        featureTd.style.width = "300px";
        tr.appendChild(featureTd);

        for (player in flashPlayers)
        {
          var td = document.createElement("td");

          var featureResult = json[category][feature][flashPlayers[player]];
          td.innerHTML = featureResult;

          if (featureResult == "Yes")
          {
            td.style.backgroundColor = "green";
          }
          else if (featureResult == "No")
          {
            td.style.backgroundColor = "orange";
          }
          else
          {
            td.style.backgroundColor = "yellow";
          }

          tr.appendChild(td);
        }
        table.appendChild(tr);
      }

      container.appendChild(table);
      var breakLine = document.createElement("br");
      container.appendChild(breakLine);
    }


});
</script>

</body>
</html>
